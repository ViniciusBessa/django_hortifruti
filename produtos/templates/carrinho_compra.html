{% extends 'base.html' %}
{% load static %}
{% load produtos_filters %}

{% block head %}
<script src="{% static 'alterar_carrinho.js' %}"></script>
{% endblock %}

{% block main %}
<section class="p-3">
    {% if carrinho_compra %}
    <h1 class="text-center mb-5">Carrinho de compras</h1>

    <div class="row container-fluid">
        <div class="col">
            <h2 class="text-center">Produtos</h2>
            {% for produto in carrinho_compra %}
            <div class="row justify-content-center py-4">
                <div class="col-auto d-flex justify-content-center px-0">
                    <a href="{% url 'pagina_produto' produto.id %}"><img src="{% static produto.imagem.path %}" width="250px" height="166px"/></a>
                </div>
                <div class="col-sm-3">
                    <div>
                        <p class="mb-1">{{ produto.titulo }}</p>
                        <h5 class="cor-dinheiro">R$ {{produto.preco }}</h5>
                        <p class="d-inline">Quantidade:</p>
                        <select id="quantidade-{{ produto.id }}" onchange="alterarCarrinho('{{ produto.id }}')">
                            {% for numero in range %}
                            {% if numero == produto|get_quantidade:quantidades %}
                            <option value="{{ numero }}" selected>{{ numero }}</option>

                            {% else %}
                            <option value="{{ numero }}">{{ numero }}</option>

                            {% endif %}
                            {% endfor%}
                        </select>   
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        <div class="col-md-4 d-flex justify-content-center">
            <div>
                <h2>Subtotal</h2>
                <h4 class="cor-dinheiro">R$ {{ subtotal }}</h4>
                <button class="btn btn-outline-secondary">Finalizar o pedido</button>
            </div>
        </div>
    </div>

    {% else %}
    <h1 class="text-center">Não há nenhum produto no carrinho</h1>

    {% endif %}
</section>
{% endblock %}